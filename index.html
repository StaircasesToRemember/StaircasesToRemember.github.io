<!DOCTYPE html>
<html>
<body>

<canvas id="arena" width="400" height="1000" style="border:0px solid black;"></canvas>

<script>
const canvas = document.getElementById("arena");
const ctx = canvas.getContext("2d");

// Player elixir values
let playerElixir = 6;
let enemyElixir = 6;
const maxElixir = 10;

// Draw elixir bar
function drawElixirBar() {
  const barWidth = 200;
  const barHeight = 20;
  const x = 100;
  const y = 650;

  // ðŸ”´ CLEAR the elixir bar area first
  ctx.clearRect(x - 5, y - 5, barWidth + 120, barHeight + 20);

  // Background
  ctx.fillStyle = "lightgray";
  ctx.fillRect(x, y, barWidth, barHeight);

  // Elixir fill
  ctx.fillStyle = "magenta";
  const fillWidth = (playerElixir / maxElixir) * barWidth;
  ctx.fillRect(x, y, fillWidth, barHeight);

  // Text
  ctx.fillStyle = "magenta";
  ctx.font = "16px Arial";
  ctx.fillText(
    playerElixir + " / " + maxElixir,
    x + barWidth + 10,
    y + barHeight - 4
  );
}

  
// Tower class
class Tower {
  constructor(x, y, hp, team) {
    this.x = x;
    this.y = y;
    this.hp = hp;
    this.maxHp = hp;
    this.team = team;
  }

  draw(ctx) {
    console.log("Inside draw for", this.team, this.x, this.y); // DEBUG
    ctx.fillStyle = this.team === "player" ? "blue" : "red";
    ctx.fillRect(this.x - 25, this.y - 25, 50, 50);
    ctx.fillStyle = "green";
    ctx.fillRect(this.x - 25, this.y - 35, 50 * (this.hp / this.maxHp), 5);
  }
}

// Create towers
const playerTowers = [
  new Tower(75, 500, 1000, "player"),
  new Tower(200, 550, 2000, "player"),
  new Tower(325, 500, 1000, "player")
];

const enemyTowers = [
  new Tower(75, 100, 1000, "enemy"),
  new Tower(200, 50, 2000, "enemy"),
  new Tower(325, 100, 1000, "enemy")
];

console.log("Player towers:", playerTowers);
console.log("Enemy towers:", enemyTowers);

// Function to generate elixir
function generateElixir() {
  if (playerElixir < maxElixir) playerElixir += 1;
  if (enemyElixir < maxElixir) enemyElixir += 1;
  
  console.log("Player Elixir:", playerElixir, "Enemy Elixir:", enemyElixir);
}
  
// Draw loop
function drawArena() {
  ctx.fillStyle = "lightgreen";
  ctx.fillRect(0, 0, canvas.width, 600);

  // Hand background
ctx.fillStyle = "#ddd";
ctx.fillRect(0, 700, canvas.width, 150);
  
   // Draw river
  ctx.fillStyle = "#1E90FF"; // blue river
  ctx.fillRect(0, 275, canvas.width, 50);

    // Draw bridges
  ctx.fillStyle = "#8B4513"; // brown
  const bridgeWidth = 50;
  const bridgeHeight = 100;
  const bridgeXs = [75, 325];

  for (let x of bridgeXs) {
    ctx.fillRect(x - bridgeWidth/2, 275 - (bridgeHeight - 50)/2, bridgeWidth, bridgeHeight);
  }
  
  for (let t of playerTowers) {
    t.draw(ctx);
  }

  for (let t of enemyTowers) {
    t.draw(ctx);
  }

  drawElixirBar();

  requestAnimationFrame(drawArena);
}

drawArena();
  
// Generate 1 elixir every 2.8 seconds
setInterval(generateElixir, 2800);
</script>

</body>
</html>
